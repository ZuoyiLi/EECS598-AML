gl1011.arc-ts.umich.edu
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From run_data_domain_fair_repr.py:594: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:305: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:314: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/musicer/fairness/env/lib/python3.7/site-packages/tensorflow_core/python/util/deprecation.py:507: UniformUnitScaling.__init__ (from tensorflow.python.ops.init_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.initializers.variance_scaling instead with distribution=uniform to get equivalent behavior.
WARNING:tensorflow:From run_data_domain_fair_repr.py:50: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.Dense instead.
WARNING:tensorflow:From /home/musicer/fairness/env/lib/python3.7/site-packages/tensorflow_core/python/layers/core.py:187: Layer.apply (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
WARNING:tensorflow:From run_data_domain_fair_repr.py:322: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /home/musicer/fairness/env/lib/python3.7/site-packages/tensorflow_core/python/ops/nn_impl.py:183: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From run_data_domain_fair_repr.py:57: The name tf.diag_part is deprecated. Please use tf.linalg.tensor_diag_part instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:80: The name tf.trace is deprecated. Please use tf.linalg.trace instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:461: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:461: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:464: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:469: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:479: The name tf.summary.merge_all is deprecated. Please use tf.compat.v1.summary.merge_all instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:483: The name tf.assign is deprecated. Please use tf.compat.v1.assign instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:600: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:502: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:510: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2021-04-04 15:40:17.123066: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2021-04-04 15:40:17.131087: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2400000000 Hz
2021-04-04 15:40:17.131194: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0xa9ded20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-04-04 15:40:17.131215: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-04-04 15:40:17.135145: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-04-04 15:40:17.283799: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0xa9e0e80 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-04-04 15:40:17.283835: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla V100-PCIE-16GB, Compute Capability 7.0
2021-04-04 15:40:17.284651: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:3b:00.0
2021-04-04 15:40:17.287882: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-04 15:40:17.307106: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-04 15:40:17.310635: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-04-04 15:40:17.313189: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-04-04 15:40:17.318574: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-04-04 15:40:17.326154: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-04-04 15:40:17.327514: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/cuda/10.0.130/lib64:/sw/arcts/centos7/python/3.7.4/lib:/sw/arcts/centos7/gcc/8.2.0/lib64:/opt/slurm/lib64::
2021-04-04 15:40:17.327531: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-04-04 15:40:17.327560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-04 15:40:17.327569: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-04-04 15:40:17.327579: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
WARNING:tensorflow:From run_data_domain_fair_repr.py:512: The name tf.set_random_seed is deprecated. Please use tf.compat.v1.set_random_seed instead.

2
median of sqrt pairwise distance 1.4257361134445339
before data_train_marginal
after data_train_marginal
after data_valid_marginal
Equal Opportunity Criterion
Traceback (most recent call last):
  File "run_data_domain_fair_repr.py", line 1017, in <module>
    features, logs_dir_f, SEED_NUM, model_config=MODEL_CONFIG, fit_config=FIT_CONFIG)
  File "run_data_domain_fair_repr.py", line 605, in train
    **fit_config)
  File "run_data_domain_fair_repr.py", line 514, in fit
    model_saver.restore(sess, last_path)
  File "/home/musicer/fairness/env/lib/python3.7/site-packages/tensorflow_core/python/training/saver.py", line 1282, in restore
    checkpoint_prefix)
ValueError: The passed save_path is not a valid checkpoint: ./models_2/last.session
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From run_data_domain_fair_repr.py:594: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:305: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:314: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/musicer/fairness/env/lib/python3.7/site-packages/tensorflow_core/python/util/deprecation.py:507: UniformUnitScaling.__init__ (from tensorflow.python.ops.init_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.initializers.variance_scaling instead with distribution=uniform to get equivalent behavior.
WARNING:tensorflow:From run_data_domain_fair_repr.py:50: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.Dense instead.
WARNING:tensorflow:From /home/musicer/fairness/env/lib/python3.7/site-packages/tensorflow_core/python/layers/core.py:187: Layer.apply (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
WARNING:tensorflow:From run_data_domain_fair_repr.py:322: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /home/musicer/fairness/env/lib/python3.7/site-packages/tensorflow_core/python/ops/nn_impl.py:183: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From run_data_domain_fair_repr.py:57: The name tf.diag_part is deprecated. Please use tf.linalg.tensor_diag_part instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:80: The name tf.trace is deprecated. Please use tf.linalg.trace instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:461: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:461: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:464: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:469: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:479: The name tf.summary.merge_all is deprecated. Please use tf.compat.v1.summary.merge_all instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:483: The name tf.assign is deprecated. Please use tf.compat.v1.assign instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:600: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:502: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:510: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2021-04-04 15:41:32.990087: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2021-04-04 15:41:32.998117: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2400000000 Hz
2021-04-04 15:41:32.998238: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0xa022210 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-04-04 15:41:32.998251: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-04-04 15:41:33.001126: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-04-04 15:41:33.152895: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0xa024370 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-04-04 15:41:33.152928: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla V100-PCIE-16GB, Compute Capability 7.0
2021-04-04 15:41:33.153738: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:3b:00.0
2021-04-04 15:41:33.154811: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-04 15:41:33.157060: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-04 15:41:33.159107: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-04-04 15:41:33.159958: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-04-04 15:41:33.162530: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-04-04 15:41:33.164665: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-04-04 15:41:33.164817: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/cuda/10.0.130/lib64:/sw/arcts/centos7/python/3.7.4/lib:/sw/arcts/centos7/gcc/8.2.0/lib64:/opt/slurm/lib64::
2021-04-04 15:41:33.164831: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-04-04 15:41:33.164859: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-04 15:41:33.164869: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-04-04 15:41:33.164879: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
WARNING:tensorflow:From run_data_domain_fair_repr.py:512: The name tf.set_random_seed is deprecated. Please use tf.compat.v1.set_random_seed instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:516: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:518: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:351: calling argmax (from tensorflow.python.ops.math_ops) with dimension is deprecated and will be removed in a future version.
Instructions for updating:
Use the `axis` argument instead
2021-04-04 17:40:46.660612: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:3b:00.0
2021-04-04 17:40:46.660724: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-04 17:40:46.660745: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-04 17:40:46.660762: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-04-04 17:40:46.660779: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-04-04 17:40:46.660795: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-04-04 17:40:46.660812: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-04-04 17:40:46.670071: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/cuda/10.0.130/lib64:/sw/arcts/centos7/python/3.7.4/lib:/sw/arcts/centos7/gcc/8.2.0/lib64:/opt/slurm/lib64::
2021-04-04 17:40:46.670088: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-04-04 17:40:46.670104: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-04 17:40:46.670113: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-04-04 17:40:46.670120: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2021-04-04 17:40:47.160401: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:3b:00.0
2021-04-04 17:40:47.160475: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-04 17:40:47.160491: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-04 17:40:47.160504: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-04-04 17:40:47.160517: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-04-04 17:40:47.160530: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-04-04 17:40:47.160543: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-04-04 17:40:47.160671: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/cuda/10.0.130/lib64:/sw/arcts/centos7/python/3.7.4/lib:/sw/arcts/centos7/gcc/8.2.0/lib64:/opt/slurm/lib64::
2021-04-04 17:40:47.160682: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-04-04 17:40:47.160698: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-04 17:40:47.160706: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-04-04 17:40:47.160714: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2021-04-04 17:40:47.395040: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:3b:00.0
2021-04-04 17:40:47.395113: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-04 17:40:47.395129: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-04 17:40:47.395142: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-04-04 17:40:47.395155: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-04-04 17:40:47.395168: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-04-04 17:40:47.395181: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-04-04 17:40:47.395318: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/cuda/10.0.130/lib64:/sw/arcts/centos7/python/3.7.4/lib:/sw/arcts/centos7/gcc/8.2.0/lib64:/opt/slurm/lib64::
2021-04-04 17:40:47.395330: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-04-04 17:40:47.395346: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-04 17:40:47.395354: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-04-04 17:40:47.395362: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
run_data_domain_fair_repr.py:253: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr_all = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:254: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr_all = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:255: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr_all = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:256: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr_all = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:270: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:271: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:272: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:273: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:253: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr_all = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:254: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr_all = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:255: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr_all = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:256: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr_all = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:270: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:271: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:272: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:273: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:253: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr_all = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:254: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr_all = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:255: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr_all = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:256: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr_all = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:270: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:271: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:272: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:273: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr = np.float(tn) / np.float(tn + fp)
3
median of sqrt pairwise distance 1.425878427466393
before data_train_marginal
after data_train_marginal
after data_valid_marginal
Equal Opportunity Criterion
Finished iteration 1000
Finished iteration 2000
Finished iteration 3000
Finished iteration 4000
Finished iteration 5000
Finished iteration 6000
Finished iteration 7000
Finished iteration 8000
Finished iteration 9000
Finished iteration 10000
Finished iteration 11000
Finished iteration 12000
Finished iteration 13000
Finished iteration 14000
Finished iteration 15000
Finished iteration 16000
Finished iteration 17000
Finished iteration 18000
Finished iteration 19000
Finished iteration 20000
Finished iteration 21000
Finished iteration 22000
Finished iteration 23000
Finished iteration 24000
Finished iteration 25000
Finished iteration 26000
Finished iteration 27000
Finished iteration 28000
Finished iteration 29000
Finished iteration 30000
Finished iteration 31000
Finished iteration 32000
Finished iteration 33000
Finished iteration 34000
Finished iteration 35000
Finished iteration 36000
Finished iteration 37000
Finished iteration 38000
Finished iteration 39000
Finished iteration 40000
Finished iteration 41000
Finished iteration 42000
Finished iteration 43000
Finished iteration 44000
Finished iteration 45000
Finished iteration 46000
Finished iteration 47000
Finished iteration 48000
Finished iteration 49000
Finished iteration 50000
after train
with Xtilde for all iterations
Regularization  1
SVM Accuracy: 83.42%
per sensitive value: 89.88, 80.26, (9.62)
SVM FPR and FNR: 8.87, 40.24
TPR per sensitive value: 57.34, 60.20, (-2.86)
FPR per sensitive value: 5.85, 10.77, (-4.92)
FNR per sensitive value: 42.66, 39.80, (2.86)
TNR per sensitive value: 94.15, 89.23, (4.92)


[0.8342]
[-2.85650745]
[-4.91771699]
with X
CV_Scores [[0.84869041 0.85274166 0.84916148]
 [0.84906727 0.8523648  0.84934992]
 [0.8492557  0.85217637 0.84934992]
 [0.84934992 0.85208216 0.84934992]
 [0.84934992 0.85208216 0.84934992]
 [0.84934992 0.85208216 0.84934992]
 [0.84934992 0.85208216 0.84934992]]
CV Mean [0.85019785 0.85026066 0.85026066 0.85026066 0.85026066 0.85026066
 0.85026066]
SVM Accuracy: 84.79%
Reg: 1000.00
per sensitive value: 92.46, 81.04, (11.42)
SVM FPR and FNR: 6.45, 42.09
TPR per sensitive value: 50.00, 59.36, (-9.36)
FPR per sensitive value: 1.97, 9.26, (-7.29)
FNR per sensitive value: 50.00, 40.64, (9.36)
TNR per sensitive value: 98.03, 90.74, (7.29)


with Xtilde
CV_Scores [[0.86819295 0.87328057 0.86706237]
 [0.86809874 0.87299793 0.86706237]
 [0.86809874 0.87328057 0.86706237]
 [0.86809874 0.87328057 0.86706237]
 [0.86809874 0.87328057 0.86706237]
 [0.86809874 0.87328057 0.86706237]
 [0.86809874 0.87328057 0.86706237]]
CV Mean [0.86951197 0.86938635 0.86948056 0.86948056 0.86948056 0.86948056
 0.86948056]
SVM Accuracy: 83.42%
reg value: 1.00
per sensitive value: 89.88, 80.26, (9.62)
SVM FPR and FNR: 8.87, 40.24
TPR per sensitive value: 57.34, 60.20, (-2.86)
FPR per sensitive value: 5.85, 10.77, (-4.92)
FNR per sensitive value: 42.66, 39.80, (2.86)
TNR per sensitive value: 94.15, 89.23, (4.92)


Encoder Accuracy: 82.99%
per sensitive value: 89.60, 79.75, (9.85)
Encoder FPR and FNR: 9.10, 41.30
TPR per sensitive value: 56.29, 59.14, (-2.85)
FPR per sensitive value: 6.03, 11.03, (-4.99)
FNR per sensitive value: 43.71, 40.86, (2.85)
TNR per sensitive value: 93.97, 88.97, (4.99)
after test
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From run_data_domain_fair_repr.py:594: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:305: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:314: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/musicer/fairness/env/lib/python3.7/site-packages/tensorflow_core/python/util/deprecation.py:507: UniformUnitScaling.__init__ (from tensorflow.python.ops.init_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.initializers.variance_scaling instead with distribution=uniform to get equivalent behavior.
WARNING:tensorflow:From run_data_domain_fair_repr.py:50: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.Dense instead.
WARNING:tensorflow:From /home/musicer/fairness/env/lib/python3.7/site-packages/tensorflow_core/python/layers/core.py:187: Layer.apply (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
WARNING:tensorflow:From run_data_domain_fair_repr.py:322: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /home/musicer/fairness/env/lib/python3.7/site-packages/tensorflow_core/python/ops/nn_impl.py:183: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From run_data_domain_fair_repr.py:57: The name tf.diag_part is deprecated. Please use tf.linalg.tensor_diag_part instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:80: The name tf.trace is deprecated. Please use tf.linalg.trace instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:461: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:461: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:464: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:469: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:479: The name tf.summary.merge_all is deprecated. Please use tf.compat.v1.summary.merge_all instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:483: The name tf.assign is deprecated. Please use tf.compat.v1.assign instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:600: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:502: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:510: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2021-04-04 17:42:30.297341: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2021-04-04 17:42:30.305368: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2400000000 Hz
2021-04-04 17:42:30.305479: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x9faeb30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-04-04 17:42:30.305490: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-04-04 17:42:30.308364: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-04-04 17:42:30.456806: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x9fb0c90 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-04-04 17:42:30.456838: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla V100-PCIE-16GB, Compute Capability 7.0
2021-04-04 17:42:30.457648: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:3b:00.0
2021-04-04 17:42:30.459597: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-04 17:42:30.462632: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-04 17:42:30.465296: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-04-04 17:42:30.466980: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-04-04 17:42:30.471390: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-04-04 17:42:30.474218: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-04-04 17:42:30.474371: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/cuda/10.0.130/lib64:/sw/arcts/centos7/python/3.7.4/lib:/sw/arcts/centos7/gcc/8.2.0/lib64:/opt/slurm/lib64::
2021-04-04 17:42:30.474385: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-04-04 17:42:30.474414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-04 17:42:30.474424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-04-04 17:42:30.474433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
WARNING:tensorflow:From run_data_domain_fair_repr.py:512: The name tf.set_random_seed is deprecated. Please use tf.compat.v1.set_random_seed instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:516: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:518: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:351: calling argmax (from tensorflow.python.ops.math_ops) with dimension is deprecated and will be removed in a future version.
Instructions for updating:
Use the `axis` argument instead
2021-04-04 19:45:20.955093: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:3b:00.0
2021-04-04 19:45:20.955219: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-04 19:45:20.955243: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-04 19:45:20.955260: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-04-04 19:45:20.955277: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-04-04 19:45:20.955292: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-04-04 19:45:20.955308: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-04-04 19:45:20.962237: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/cuda/10.0.130/lib64:/sw/arcts/centos7/python/3.7.4/lib:/sw/arcts/centos7/gcc/8.2.0/lib64:/opt/slurm/lib64::
2021-04-04 19:45:20.962253: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-04-04 19:45:20.962270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-04 19:45:20.962278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-04-04 19:45:20.962286: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2021-04-04 19:45:21.454179: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:3b:00.0
2021-04-04 19:45:21.454264: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-04 19:45:21.454280: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-04 19:45:21.454293: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-04-04 19:45:21.454306: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-04-04 19:45:21.454318: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-04-04 19:45:21.454331: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-04-04 19:45:21.454458: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/cuda/10.0.130/lib64:/sw/arcts/centos7/python/3.7.4/lib:/sw/arcts/centos7/gcc/8.2.0/lib64:/opt/slurm/lib64::
2021-04-04 19:45:21.454470: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-04-04 19:45:21.454485: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-04 19:45:21.454493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-04-04 19:45:21.454501: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2021-04-04 19:45:21.687460: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:3b:00.0
2021-04-04 19:45:21.687536: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-04 19:45:21.687551: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-04 19:45:21.687564: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-04-04 19:45:21.687577: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-04-04 19:45:21.687590: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-04-04 19:45:21.687602: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-04-04 19:45:21.687728: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/cuda/10.0.130/lib64:/sw/arcts/centos7/python/3.7.4/lib:/sw/arcts/centos7/gcc/8.2.0/lib64:/opt/slurm/lib64::
2021-04-04 19:45:21.687740: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-04-04 19:45:21.687755: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-04 19:45:21.687763: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-04-04 19:45:21.687771: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
run_data_domain_fair_repr.py:253: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr_all = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:254: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr_all = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:255: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr_all = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:256: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr_all = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:270: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:271: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:272: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:273: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:253: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr_all = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:254: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr_all = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:255: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr_all = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:256: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr_all = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:270: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:271: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:272: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:273: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:253: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr_all = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:254: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr_all = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:255: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr_all = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:256: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr_all = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:270: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:271: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:272: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:273: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr = np.float(tn) / np.float(tn + fp)
4
median of sqrt pairwise distance 1.4259660354923338
before data_train_marginal
after data_train_marginal
after data_valid_marginal
Equal Opportunity Criterion
Finished iteration 1000
Finished iteration 2000
Finished iteration 3000
Finished iteration 4000
Finished iteration 5000
Finished iteration 6000
Finished iteration 7000
Finished iteration 8000
Finished iteration 9000
Finished iteration 10000
Finished iteration 11000
Finished iteration 12000
Finished iteration 13000
Finished iteration 14000
Finished iteration 15000
Finished iteration 16000
Finished iteration 17000
Finished iteration 18000
Finished iteration 19000
Finished iteration 20000
Finished iteration 21000
Finished iteration 22000
Finished iteration 23000
Finished iteration 24000
Finished iteration 25000
Finished iteration 26000
Finished iteration 27000
Finished iteration 28000
Finished iteration 29000
Finished iteration 30000
Finished iteration 31000
Finished iteration 32000
Finished iteration 33000
Finished iteration 34000
Finished iteration 35000
Finished iteration 36000
Finished iteration 37000
Finished iteration 38000
Finished iteration 39000
Finished iteration 40000
Finished iteration 41000
Finished iteration 42000
Finished iteration 43000
Finished iteration 44000
Finished iteration 45000
Finished iteration 46000
Finished iteration 47000
Finished iteration 48000
Finished iteration 49000
Finished iteration 50000
after train
with Xtilde for all iterations
Regularization  1
SVM Accuracy: 84.37%
per sensitive value: 90.98, 81.10, (9.88)
SVM FPR and FNR: 8.22, 39.02
TPR per sensitive value: 56.15, 61.80, (-5.64)
FPR per sensitive value: 4.95, 10.32, (-5.38)
FNR per sensitive value: 43.85, 38.20, (5.64)
TNR per sensitive value: 95.05, 89.68, (5.38)


[0.84373333]
[-5.64135799]
[-5.3764446]
with X
CV_Scores [[0.85321274 0.843697   0.84727718]
 [0.85349538 0.84473337 0.84690032]
 [0.8535896  0.84473337 0.84699454]
 [0.8535896  0.84473337 0.84699454]
 [0.8535896  0.84473337 0.84699454]
 [0.8535896  0.84473337 0.84699454]
 [0.8535896  0.84473337 0.84699454]]
CV Mean [0.84806231 0.84837636 0.84843917 0.84843917 0.84843917 0.84843917
 0.84843917]
SVM Accuracy: 85.45%
Reg: 100.00
per sensitive value: 92.89, 81.76, (11.14)
SVM FPR and FNR: 5.96, 41.71
TPR per sensitive value: 53.08, 59.17, (-6.09)
FPR per sensitive value: 2.45, 8.21, (-5.76)
FNR per sensitive value: 46.92, 40.83, (6.09)
TNR per sensitive value: 97.55, 91.79, (5.76)


with Xtilde
CV_Scores [[0.87375165 0.86743923 0.86979461]
 [0.87337479 0.86687394 0.86998304]
 [0.87318636 0.86687394 0.87007726]
 [0.87318636 0.86687394 0.87007726]
 [0.87318636 0.86687394 0.87007726]
 [0.87318636 0.86687394 0.87007726]
 [0.87318636 0.86687394 0.87007726]]
CV Mean [0.8703285  0.87007726 0.87004585 0.87004585 0.87004585 0.87004585
 0.87004585]
SVM Accuracy: 84.37%
reg value: 1.00
per sensitive value: 90.98, 81.10, (9.88)
SVM FPR and FNR: 8.22, 39.02
TPR per sensitive value: 56.15, 61.80, (-5.64)
FPR per sensitive value: 4.95, 10.32, (-5.38)
FNR per sensitive value: 43.85, 38.20, (5.64)
TNR per sensitive value: 95.05, 89.68, (5.38)


Encoder Accuracy: 83.59%
per sensitive value: 90.06, 80.39, (9.66)
Encoder FPR and FNR: 10.92, 33.75
TPR per sensitive value: 62.69, 66.85, (-4.16)
FPR per sensitive value: 6.74, 13.59, (-6.85)
FNR per sensitive value: 37.31, 33.15, (4.16)
TNR per sensitive value: 93.26, 86.41, (6.85)
after test
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From run_data_domain_fair_repr.py:594: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:305: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:314: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/musicer/fairness/env/lib/python3.7/site-packages/tensorflow_core/python/util/deprecation.py:507: UniformUnitScaling.__init__ (from tensorflow.python.ops.init_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.initializers.variance_scaling instead with distribution=uniform to get equivalent behavior.
WARNING:tensorflow:From run_data_domain_fair_repr.py:50: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.Dense instead.
WARNING:tensorflow:From /home/musicer/fairness/env/lib/python3.7/site-packages/tensorflow_core/python/layers/core.py:187: Layer.apply (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
WARNING:tensorflow:From run_data_domain_fair_repr.py:322: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /home/musicer/fairness/env/lib/python3.7/site-packages/tensorflow_core/python/ops/nn_impl.py:183: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From run_data_domain_fair_repr.py:57: The name tf.diag_part is deprecated. Please use tf.linalg.tensor_diag_part instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:80: The name tf.trace is deprecated. Please use tf.linalg.trace instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:461: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:461: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:464: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:469: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:479: The name tf.summary.merge_all is deprecated. Please use tf.compat.v1.summary.merge_all instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:483: The name tf.assign is deprecated. Please use tf.compat.v1.assign instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:600: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:502: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:510: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2021-04-04 19:47:03.788818: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2021-04-04 19:47:03.796815: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2400000000 Hz
2021-04-04 19:47:03.796926: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0xa568d90 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-04-04 19:47:03.796938: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-04-04 19:47:03.799833: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-04-04 19:47:03.946487: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0xa56aef0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-04-04 19:47:03.946519: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla V100-PCIE-16GB, Compute Capability 7.0
2021-04-04 19:47:03.947326: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:3b:00.0
2021-04-04 19:47:03.949463: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-04 19:47:03.952486: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-04 19:47:03.954909: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-04-04 19:47:03.956414: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-04-04 19:47:03.959396: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-04-04 19:47:03.962239: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-04-04 19:47:03.962394: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/cuda/10.0.130/lib64:/sw/arcts/centos7/python/3.7.4/lib:/sw/arcts/centos7/gcc/8.2.0/lib64:/opt/slurm/lib64::
2021-04-04 19:47:03.962409: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-04-04 19:47:03.962436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-04 19:47:03.962446: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-04-04 19:47:03.962455: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
WARNING:tensorflow:From run_data_domain_fair_repr.py:512: The name tf.set_random_seed is deprecated. Please use tf.compat.v1.set_random_seed instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:516: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:518: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:351: calling argmax (from tensorflow.python.ops.math_ops) with dimension is deprecated and will be removed in a future version.
Instructions for updating:
Use the `axis` argument instead
2021-04-04 21:48:40.074966: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:3b:00.0
2021-04-04 21:48:40.075081: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-04 21:48:40.075102: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-04 21:48:40.075120: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-04-04 21:48:40.075138: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-04-04 21:48:40.075153: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-04-04 21:48:40.075169: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-04-04 21:48:40.080173: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/cuda/10.0.130/lib64:/sw/arcts/centos7/python/3.7.4/lib:/sw/arcts/centos7/gcc/8.2.0/lib64:/opt/slurm/lib64::
2021-04-04 21:48:40.080190: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-04-04 21:48:40.080213: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-04 21:48:40.080222: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-04-04 21:48:40.080230: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2021-04-04 21:48:40.572362: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:3b:00.0
2021-04-04 21:48:40.572432: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-04 21:48:40.572448: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-04 21:48:40.572461: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-04-04 21:48:40.572474: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-04-04 21:48:40.572487: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-04-04 21:48:40.572500: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-04-04 21:48:40.572624: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/cuda/10.0.130/lib64:/sw/arcts/centos7/python/3.7.4/lib:/sw/arcts/centos7/gcc/8.2.0/lib64:/opt/slurm/lib64::
2021-04-04 21:48:40.572636: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-04-04 21:48:40.572652: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-04 21:48:40.572660: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-04-04 21:48:40.572667: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2021-04-04 21:48:40.805420: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:3b:00.0
2021-04-04 21:48:40.805497: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-04 21:48:40.805513: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-04 21:48:40.805526: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-04-04 21:48:40.805539: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-04-04 21:48:40.805552: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-04-04 21:48:40.805565: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-04-04 21:48:40.805688: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/cuda/10.0.130/lib64:/sw/arcts/centos7/python/3.7.4/lib:/sw/arcts/centos7/gcc/8.2.0/lib64:/opt/slurm/lib64::
2021-04-04 21:48:40.805700: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-04-04 21:48:40.805715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-04 21:48:40.805723: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-04-04 21:48:40.805731: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
run_data_domain_fair_repr.py:253: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr_all = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:254: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr_all = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:255: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr_all = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:256: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr_all = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:270: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:271: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:272: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:273: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:253: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr_all = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:254: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr_all = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:255: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr_all = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:256: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr_all = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:270: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:271: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:272: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:273: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:253: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr_all = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:254: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr_all = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:255: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr_all = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:256: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr_all = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:270: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:271: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:272: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:273: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr = np.float(tn) / np.float(tn + fp)
5
median of sqrt pairwise distance 1.4258617573024985
before data_train_marginal
after data_train_marginal
after data_valid_marginal
Equal Opportunity Criterion
Finished iteration 1000
Finished iteration 2000
Finished iteration 3000
Finished iteration 4000
Finished iteration 5000
Finished iteration 6000
Finished iteration 7000
Finished iteration 8000
Finished iteration 9000
Finished iteration 10000
Finished iteration 11000
Finished iteration 12000
Finished iteration 13000
Finished iteration 14000
Finished iteration 15000
Finished iteration 16000
Finished iteration 17000
Finished iteration 18000
Finished iteration 19000
Finished iteration 20000
Finished iteration 21000
Finished iteration 22000
Finished iteration 23000
Finished iteration 24000
Finished iteration 25000
Finished iteration 26000
Finished iteration 27000
Finished iteration 28000
Finished iteration 29000
Finished iteration 30000
Finished iteration 31000
Finished iteration 32000
Finished iteration 33000
Finished iteration 34000
Finished iteration 35000
Finished iteration 36000
Finished iteration 37000
Finished iteration 38000
Finished iteration 39000
Finished iteration 40000
Finished iteration 41000
Finished iteration 42000
Finished iteration 43000
Finished iteration 44000
Finished iteration 45000
Finished iteration 46000
Finished iteration 47000
Finished iteration 48000
Finished iteration 49000
Finished iteration 50000
after train
with Xtilde for all iterations
Regularization  10
SVM Accuracy: 84.12%
per sensitive value: 90.87, 80.82, (10.05)
SVM FPR and FNR: 8.56, 39.06
TPR per sensitive value: 53.77, 62.18, (-8.41)
FPR per sensitive value: 4.66, 11.01, (-6.35)
FNR per sensitive value: 46.23, 37.82, (8.41)
TNR per sensitive value: 95.34, 88.99, (6.35)


[0.8412]
[-8.40882552]
[-6.3472976]
with X
CV_Scores [[0.85038628 0.84699454 0.85311852]
 [0.85142265 0.84708875 0.85377803]
 [0.85132843 0.84699454 0.85368381]
 [0.85132843 0.84708875 0.85368381]
 [0.85132843 0.84708875 0.85368381]
 [0.85132843 0.84708875 0.85368381]
 [0.85132843 0.84708875 0.85368381]]
CV Mean [0.85016645 0.85076314 0.85066893 0.85070033 0.85070033 0.85070033
 0.85070033]
SVM Accuracy: 85.19%
Reg: 10.00
per sensitive value: 92.45, 81.64, (10.81)
SVM FPR and FNR: 6.11, 42.36
TPR per sensitive value: 50.38, 58.89, (-8.52)
FPR per sensitive value: 2.48, 8.38, (-5.90)
FNR per sensitive value: 49.62, 41.11, (8.52)
TNR per sensitive value: 97.52, 91.62, (5.90)


with Xtilde
CV_Scores [[0.866026   0.86809874 0.87026569]
 [0.86649708 0.86772188 0.8703599 ]
 [0.86640286 0.86762766 0.87045412]
 [0.86640286 0.86762766 0.87045412]
 [0.86640286 0.86762766 0.87045412]
 [0.86640286 0.86762766 0.87045412]
 [0.86640286 0.86762766 0.87045412]]
CV Mean [0.86813014 0.86819295 0.86816155 0.86816155 0.86816155 0.86816155
 0.86816155]
SVM Accuracy: 84.12%
reg value: 10.00
per sensitive value: 90.87, 80.82, (10.05)
SVM FPR and FNR: 8.56, 39.06
TPR per sensitive value: 53.77, 62.18, (-8.41)
FPR per sensitive value: 4.66, 11.01, (-6.35)
FNR per sensitive value: 46.23, 37.82, (8.41)
TNR per sensitive value: 95.34, 88.99, (6.35)


Encoder Accuracy: 83.90%
per sensitive value: 90.32, 80.76, (9.56)
Encoder FPR and FNR: 8.93, 38.81
TPR per sensitive value: 51.89, 62.80, (-10.91)
FPR per sensitive value: 5.05, 11.37, (-6.32)
FNR per sensitive value: 48.11, 37.20, (10.91)
TNR per sensitive value: 94.95, 88.63, (6.32)
after test
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From run_data_domain_fair_repr.py:594: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:305: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:314: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/musicer/fairness/env/lib/python3.7/site-packages/tensorflow_core/python/util/deprecation.py:507: UniformUnitScaling.__init__ (from tensorflow.python.ops.init_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.initializers.variance_scaling instead with distribution=uniform to get equivalent behavior.
WARNING:tensorflow:From run_data_domain_fair_repr.py:50: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.Dense instead.
WARNING:tensorflow:From /home/musicer/fairness/env/lib/python3.7/site-packages/tensorflow_core/python/layers/core.py:187: Layer.apply (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
WARNING:tensorflow:From run_data_domain_fair_repr.py:322: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /home/musicer/fairness/env/lib/python3.7/site-packages/tensorflow_core/python/ops/nn_impl.py:183: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From run_data_domain_fair_repr.py:57: The name tf.diag_part is deprecated. Please use tf.linalg.tensor_diag_part instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:80: The name tf.trace is deprecated. Please use tf.linalg.trace instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:461: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:461: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:464: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:469: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:479: The name tf.summary.merge_all is deprecated. Please use tf.compat.v1.summary.merge_all instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:483: The name tf.assign is deprecated. Please use tf.compat.v1.assign instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:600: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:502: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:510: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2021-04-04 21:50:19.617892: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2021-04-04 21:50:19.625899: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2400000000 Hz
2021-04-04 21:50:19.626007: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0xb727bc0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-04-04 21:50:19.626019: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-04-04 21:50:19.628895: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-04-04 21:50:19.774981: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0xb729d20 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-04-04 21:50:19.775012: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla V100-PCIE-16GB, Compute Capability 7.0
2021-04-04 21:50:19.775840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:3b:00.0
2021-04-04 21:50:19.776743: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-04 21:50:19.778974: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-04 21:50:19.781040: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-04-04 21:50:19.781870: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-04-04 21:50:19.784486: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-04-04 21:50:19.786545: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-04-04 21:50:19.786701: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/cuda/10.0.130/lib64:/sw/arcts/centos7/python/3.7.4/lib:/sw/arcts/centos7/gcc/8.2.0/lib64:/opt/slurm/lib64::
2021-04-04 21:50:19.786715: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-04-04 21:50:19.786742: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-04 21:50:19.786752: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-04-04 21:50:19.786761: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
WARNING:tensorflow:From run_data_domain_fair_repr.py:512: The name tf.set_random_seed is deprecated. Please use tf.compat.v1.set_random_seed instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:516: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:518: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:351: calling argmax (from tensorflow.python.ops.math_ops) with dimension is deprecated and will be removed in a future version.
Instructions for updating:
Use the `axis` argument instead
2021-04-04 23:50:23.876228: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:3b:00.0
2021-04-04 23:50:23.876345: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-04 23:50:23.876368: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-04 23:50:23.876385: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-04-04 23:50:23.876403: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-04-04 23:50:23.876418: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-04-04 23:50:23.876434: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-04-04 23:50:23.885844: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/cuda/10.0.130/lib64:/sw/arcts/centos7/python/3.7.4/lib:/sw/arcts/centos7/gcc/8.2.0/lib64:/opt/slurm/lib64::
2021-04-04 23:50:23.885861: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-04-04 23:50:23.885877: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-04 23:50:23.885885: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-04-04 23:50:23.885893: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2021-04-04 23:50:24.381830: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:3b:00.0
2021-04-04 23:50:24.381902: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-04 23:50:24.381917: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-04 23:50:24.381931: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-04-04 23:50:24.381944: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-04-04 23:50:24.381957: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-04-04 23:50:24.381970: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-04-04 23:50:24.382100: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/cuda/10.0.130/lib64:/sw/arcts/centos7/python/3.7.4/lib:/sw/arcts/centos7/gcc/8.2.0/lib64:/opt/slurm/lib64::
2021-04-04 23:50:24.382112: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-04-04 23:50:24.382127: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-04 23:50:24.382135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-04-04 23:50:24.382143: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2021-04-04 23:50:24.615667: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:3b:00.0
2021-04-04 23:50:24.615740: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-04 23:50:24.615756: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-04 23:50:24.615769: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-04-04 23:50:24.615782: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-04-04 23:50:24.615794: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-04-04 23:50:24.615807: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-04-04 23:50:24.615937: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/cuda/10.0.130/lib64:/sw/arcts/centos7/python/3.7.4/lib:/sw/arcts/centos7/gcc/8.2.0/lib64:/opt/slurm/lib64::
2021-04-04 23:50:24.615949: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-04-04 23:50:24.615964: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-04 23:50:24.615972: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-04-04 23:50:24.615980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
run_data_domain_fair_repr.py:253: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr_all = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:254: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr_all = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:255: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr_all = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:256: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr_all = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:270: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:271: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:272: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:273: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:253: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr_all = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:254: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr_all = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:255: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr_all = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:256: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr_all = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:270: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:271: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:272: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:273: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:253: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr_all = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:254: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr_all = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:255: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr_all = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:256: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr_all = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:270: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:271: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:272: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:273: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr = np.float(tn) / np.float(tn + fp)
6
median of sqrt pairwise distance 1.4259081968667382
before data_train_marginal
after data_train_marginal
after data_valid_marginal
Equal Opportunity Criterion
Finished iteration 1000
Finished iteration 2000
Finished iteration 3000
Finished iteration 4000
Finished iteration 5000
Finished iteration 6000
Finished iteration 7000
Finished iteration 8000
Finished iteration 9000
Finished iteration 10000
Finished iteration 11000
Finished iteration 12000
Finished iteration 13000
Finished iteration 14000
Finished iteration 15000
Finished iteration 16000
Finished iteration 17000
Finished iteration 18000
Finished iteration 19000
Finished iteration 20000
Finished iteration 21000
Finished iteration 22000
Finished iteration 23000
Finished iteration 24000
Finished iteration 25000
Finished iteration 26000
Finished iteration 27000
Finished iteration 28000
Finished iteration 29000
Finished iteration 30000
Finished iteration 31000
Finished iteration 32000
Finished iteration 33000
Finished iteration 34000
Finished iteration 35000
Finished iteration 36000
Finished iteration 37000
Finished iteration 38000
Finished iteration 39000
Finished iteration 40000
Finished iteration 41000
Finished iteration 42000
Finished iteration 43000
Finished iteration 44000
Finished iteration 45000
Finished iteration 46000
Finished iteration 47000
Finished iteration 48000
Finished iteration 49000
Finished iteration 50000
after train
with Xtilde for all iterations
Regularization  1
SVM Accuracy: 84.05%
per sensitive value: 90.02, 81.11, (8.91)
SVM FPR and FNR: 9.14, 37.24
TPR per sensitive value: 56.61, 63.88, (-7.27)
FPR per sensitive value: 5.71, 11.30, (-5.58)
FNR per sensitive value: 43.39, 36.12, (7.27)
TNR per sensitive value: 94.29, 88.70, (5.58)


[0.84053333]
[-7.2718028]
[-5.58255479]
with X
CV_Scores [[0.85274166 0.84887884 0.85076314]
 [0.8535896  0.84916148 0.8504805 ]
 [0.85340117 0.84934992 0.85057471]
 [0.85340117 0.84934992 0.85057471]
 [0.85340117 0.84934992 0.85057471]
 [0.85340117 0.84934992 0.85057471]
 [0.85340117 0.84934992 0.85057471]]
CV Mean [0.85079455 0.85107719 0.8511086  0.8511086  0.8511086  0.8511086
 0.8511086 ]
SVM Accuracy: 84.96%
Reg: 100.00
per sensitive value: 92.18, 81.40, (10.79)
SVM FPR and FNR: 6.69, 41.15
TPR per sensitive value: 49.29, 60.59, (-11.31)
FPR per sensitive value: 2.35, 9.43, (-7.09)
FNR per sensitive value: 50.71, 39.41, (11.31)
TNR per sensitive value: 97.65, 90.57, (7.09)


with Xtilde
CV_Scores [[0.87394008 0.86960618 0.87337479]
 [0.87375165 0.86932353 0.87290371]
 [0.87365743 0.86951197 0.87290371]
 [0.87365743 0.86951197 0.87290371]
 [0.87365743 0.86951197 0.87290371]
 [0.87365743 0.86951197 0.87290371]
 [0.87365743 0.86951197 0.87290371]]
CV Mean [0.87230702 0.87199297 0.87202437 0.87202437 0.87202437 0.87202437
 0.87202437]
SVM Accuracy: 84.05%
reg value: 1.00
per sensitive value: 90.02, 81.11, (8.91)
SVM FPR and FNR: 9.14, 37.24
TPR per sensitive value: 56.61, 63.88, (-7.27)
FPR per sensitive value: 5.71, 11.30, (-5.58)
FNR per sensitive value: 43.39, 36.12, (7.27)
TNR per sensitive value: 94.29, 88.70, (5.58)


Encoder Accuracy: 82.16%
per sensitive value: 88.73, 78.92, (9.81)
Encoder FPR and FNR: 14.31, 28.87
TPR per sensitive value: 60.71, 73.02, (-12.31)
FPR per sensitive value: 7.70, 18.48, (-10.78)
FNR per sensitive value: 39.29, 26.98, (12.31)
TNR per sensitive value: 92.30, 81.52, (10.78)
after test
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From run_data_domain_fair_repr.py:594: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:305: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:314: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/musicer/fairness/env/lib/python3.7/site-packages/tensorflow_core/python/util/deprecation.py:507: UniformUnitScaling.__init__ (from tensorflow.python.ops.init_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.initializers.variance_scaling instead with distribution=uniform to get equivalent behavior.
WARNING:tensorflow:From run_data_domain_fair_repr.py:50: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.Dense instead.
WARNING:tensorflow:From /home/musicer/fairness/env/lib/python3.7/site-packages/tensorflow_core/python/layers/core.py:187: Layer.apply (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
WARNING:tensorflow:From run_data_domain_fair_repr.py:322: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /home/musicer/fairness/env/lib/python3.7/site-packages/tensorflow_core/python/ops/nn_impl.py:183: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From run_data_domain_fair_repr.py:57: The name tf.diag_part is deprecated. Please use tf.linalg.tensor_diag_part instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:80: The name tf.trace is deprecated. Please use tf.linalg.trace instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:461: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:461: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:464: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:469: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:479: The name tf.summary.merge_all is deprecated. Please use tf.compat.v1.summary.merge_all instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:483: The name tf.assign is deprecated. Please use tf.compat.v1.assign instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:600: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:502: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:510: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2021-04-04 23:52:08.187188: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2021-04-04 23:52:08.195236: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2400000000 Hz
2021-04-04 23:52:08.195347: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x98a2d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-04-04 23:52:08.195359: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-04-04 23:52:08.198259: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-04-04 23:52:08.347271: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x98a4e90 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-04-04 23:52:08.347302: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla V100-PCIE-16GB, Compute Capability 7.0
2021-04-04 23:52:08.348114: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:3b:00.0
2021-04-04 23:52:08.350633: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-04 23:52:08.432880: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-04 23:52:08.440700: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-04-04 23:52:08.442022: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-04-04 23:52:08.446258: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-04-04 23:52:08.448805: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-04-04 23:52:08.448955: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/cuda/10.0.130/lib64:/sw/arcts/centos7/python/3.7.4/lib:/sw/arcts/centos7/gcc/8.2.0/lib64:/opt/slurm/lib64::
2021-04-04 23:52:08.448970: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-04-04 23:52:08.448999: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-04 23:52:08.449008: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-04-04 23:52:08.449018: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
WARNING:tensorflow:From run_data_domain_fair_repr.py:512: The name tf.set_random_seed is deprecated. Please use tf.compat.v1.set_random_seed instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:516: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:518: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:351: calling argmax (from tensorflow.python.ops.math_ops) with dimension is deprecated and will be removed in a future version.
Instructions for updating:
Use the `axis` argument instead
2021-04-05 01:53:44.717001: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:3b:00.0
2021-04-05 01:53:44.717120: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-05 01:53:44.717141: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-05 01:53:44.717158: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-04-05 01:53:44.717176: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-04-05 01:53:44.717191: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-04-05 01:53:44.717217: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-04-05 01:53:44.723970: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/cuda/10.0.130/lib64:/sw/arcts/centos7/python/3.7.4/lib:/sw/arcts/centos7/gcc/8.2.0/lib64:/opt/slurm/lib64::
2021-04-05 01:53:44.723986: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-04-05 01:53:44.724002: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-05 01:53:44.724011: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-04-05 01:53:44.724019: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2021-04-05 01:53:45.200712: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:3b:00.0
2021-04-05 01:53:45.200783: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-05 01:53:45.200799: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-05 01:53:45.200813: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-04-05 01:53:45.200826: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-04-05 01:53:45.200839: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-04-05 01:53:45.200852: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-04-05 01:53:45.200980: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/cuda/10.0.130/lib64:/sw/arcts/centos7/python/3.7.4/lib:/sw/arcts/centos7/gcc/8.2.0/lib64:/opt/slurm/lib64::
2021-04-05 01:53:45.200992: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-04-05 01:53:45.201008: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-05 01:53:45.201016: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-04-05 01:53:45.201024: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2021-04-05 01:53:45.433959: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:3b:00.0
2021-04-05 01:53:45.434029: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-05 01:53:45.434045: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-05 01:53:45.434058: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-04-05 01:53:45.434072: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-04-05 01:53:45.434085: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-04-05 01:53:45.434098: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-04-05 01:53:45.434234: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/cuda/10.0.130/lib64:/sw/arcts/centos7/python/3.7.4/lib:/sw/arcts/centos7/gcc/8.2.0/lib64:/opt/slurm/lib64::
2021-04-05 01:53:45.434246: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-04-05 01:53:45.434261: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-05 01:53:45.434269: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-04-05 01:53:45.434277: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
run_data_domain_fair_repr.py:253: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr_all = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:254: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr_all = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:255: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr_all = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:256: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr_all = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:270: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:271: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:272: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:273: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:253: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr_all = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:254: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr_all = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:255: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr_all = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:256: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr_all = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:270: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:271: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:272: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:273: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:253: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr_all = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:254: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr_all = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:255: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr_all = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:256: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr_all = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:270: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:271: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:272: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:273: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr = np.float(tn) / np.float(tn + fp)
7
median of sqrt pairwise distance 1.42605119803043
before data_train_marginal
after data_train_marginal
after data_valid_marginal
Equal Opportunity Criterion
Finished iteration 1000
Finished iteration 2000
Finished iteration 3000
Finished iteration 4000
Finished iteration 5000
Finished iteration 6000
Finished iteration 7000
Finished iteration 8000
Finished iteration 9000
Finished iteration 10000
Finished iteration 11000
Finished iteration 12000
Finished iteration 13000
Finished iteration 14000
Finished iteration 15000
Finished iteration 16000
Finished iteration 17000
Finished iteration 18000
Finished iteration 19000
Finished iteration 20000
Finished iteration 21000
Finished iteration 22000
Finished iteration 23000
Finished iteration 24000
Finished iteration 25000
Finished iteration 26000
Finished iteration 27000
Finished iteration 28000
Finished iteration 29000
Finished iteration 30000
Finished iteration 31000
Finished iteration 32000
Finished iteration 33000
Finished iteration 34000
Finished iteration 35000
Finished iteration 36000
Finished iteration 37000
Finished iteration 38000
Finished iteration 39000
Finished iteration 40000
Finished iteration 41000
Finished iteration 42000
Finished iteration 43000
Finished iteration 44000
Finished iteration 45000
Finished iteration 46000
Finished iteration 47000
Finished iteration 48000
Finished iteration 49000
Finished iteration 50000
after train
with Xtilde for all iterations
Regularization  1
SVM Accuracy: 83.99%
per sensitive value: 90.54, 80.77, (9.77)
SVM FPR and FNR: 8.33, 40.41
TPR per sensitive value: 50.85, 61.10, (-10.25)
FPR per sensitive value: 4.71, 10.62, (-5.91)
FNR per sensitive value: 49.15, 38.90, (10.25)
TNR per sensitive value: 95.29, 89.38, (5.91)


[0.83993333]
[-10.25319206]
[-5.90821725]
with X
CV_Scores [[0.84963256 0.85255323 0.84812512]
 [0.84991521 0.85340117 0.84812512]
 [0.84982099 0.85311852 0.84831355]
 [0.84991521 0.85311852 0.84840776]
 [0.84991521 0.85311852 0.84840776]
 [0.84991521 0.85311852 0.84840776]
 [0.84991521 0.85311852 0.84840776]]
CV Mean [0.85010364 0.8504805  0.85041769 0.8504805  0.8504805  0.8504805
 0.8504805 ]
SVM Accuracy: 85.11%
Reg: 10.00
per sensitive value: 92.81, 81.33, (11.48)
SVM FPR and FNR: 6.01, 43.08
TPR per sensitive value: 48.96, 58.30, (-9.33)
FPR per sensitive value: 1.95, 8.58, (-6.64)
FNR per sensitive value: 51.04, 41.70, (9.33)
TNR per sensitive value: 98.05, 91.42, (6.64)


with Xtilde
CV_Scores [[0.87026569 0.87139627 0.8697004 ]
 [0.86960618 0.8715847  0.86988883]
 [0.86951197 0.87167891 0.86998304]
 [0.86951197 0.87167891 0.86998304]
 [0.86951197 0.87167891 0.86998304]
 [0.86951197 0.87167891 0.86998304]
 [0.86951197 0.87167891 0.86998304]]
CV Mean [0.87045412 0.8703599  0.87039131 0.87039131 0.87039131 0.87039131
 0.87039131]
SVM Accuracy: 83.99%
reg value: 1.00
per sensitive value: 90.54, 80.77, (9.77)
SVM FPR and FNR: 8.33, 40.41
TPR per sensitive value: 50.85, 61.10, (-10.25)
FPR per sensitive value: 4.71, 10.62, (-5.91)
FNR per sensitive value: 49.15, 38.90, (10.25)
TNR per sensitive value: 95.29, 89.38, (5.91)


Encoder Accuracy: 83.94%
per sensitive value: 90.66, 80.63, (10.03)
Encoder FPR and FNR: 8.37, 40.49
TPR per sensitive value: 52.17, 60.78, (-8.60)
FPR per sensitive value: 4.73, 10.67, (-5.94)
FNR per sensitive value: 47.83, 39.22, (8.60)
TNR per sensitive value: 95.27, 89.33, (5.94)
after test
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From run_data_domain_fair_repr.py:594: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:305: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:314: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/musicer/fairness/env/lib/python3.7/site-packages/tensorflow_core/python/util/deprecation.py:507: UniformUnitScaling.__init__ (from tensorflow.python.ops.init_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.initializers.variance_scaling instead with distribution=uniform to get equivalent behavior.
WARNING:tensorflow:From run_data_domain_fair_repr.py:50: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.Dense instead.
WARNING:tensorflow:From /home/musicer/fairness/env/lib/python3.7/site-packages/tensorflow_core/python/layers/core.py:187: Layer.apply (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
WARNING:tensorflow:From run_data_domain_fair_repr.py:322: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /home/musicer/fairness/env/lib/python3.7/site-packages/tensorflow_core/python/ops/nn_impl.py:183: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From run_data_domain_fair_repr.py:57: The name tf.diag_part is deprecated. Please use tf.linalg.tensor_diag_part instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:80: The name tf.trace is deprecated. Please use tf.linalg.trace instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:461: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:461: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:464: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:469: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:479: The name tf.summary.merge_all is deprecated. Please use tf.compat.v1.summary.merge_all instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:483: The name tf.assign is deprecated. Please use tf.compat.v1.assign instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:600: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:502: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:510: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2021-04-05 01:55:28.507754: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2021-04-05 01:55:28.515726: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2400000000 Hz
2021-04-05 01:55:28.515832: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0xb0657a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-04-05 01:55:28.515844: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-04-05 01:55:28.518747: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-04-05 01:55:28.668979: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0xb067900 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-04-05 01:55:28.669012: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla V100-PCIE-16GB, Compute Capability 7.0
2021-04-05 01:55:28.670854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:3b:00.0
2021-04-05 01:55:28.671865: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-05 01:55:28.674061: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-05 01:55:28.676115: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-04-05 01:55:28.677096: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-04-05 01:55:28.679662: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-04-05 01:55:28.681784: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-04-05 01:55:28.681938: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/cuda/10.0.130/lib64:/sw/arcts/centos7/python/3.7.4/lib:/sw/arcts/centos7/gcc/8.2.0/lib64:/opt/slurm/lib64::
2021-04-05 01:55:28.681952: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-04-05 01:55:28.681980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-05 01:55:28.681990: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-04-05 01:55:28.681999: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
WARNING:tensorflow:From run_data_domain_fair_repr.py:512: The name tf.set_random_seed is deprecated. Please use tf.compat.v1.set_random_seed instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:516: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:518: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:351: calling argmax (from tensorflow.python.ops.math_ops) with dimension is deprecated and will be removed in a future version.
Instructions for updating:
Use the `axis` argument instead
2021-04-05 03:58:19.532930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:3b:00.0
2021-04-05 03:58:19.533045: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-05 03:58:19.533067: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-05 03:58:19.533086: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-04-05 03:58:19.533102: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-04-05 03:58:19.533117: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-04-05 03:58:19.533134: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-04-05 03:58:19.540273: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/cuda/10.0.130/lib64:/sw/arcts/centos7/python/3.7.4/lib:/sw/arcts/centos7/gcc/8.2.0/lib64:/opt/slurm/lib64::
2021-04-05 03:58:19.540290: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-04-05 03:58:19.540307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-05 03:58:19.540315: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-04-05 03:58:19.540323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2021-04-05 03:58:20.035624: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:3b:00.0
2021-04-05 03:58:20.035698: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-05 03:58:20.035714: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-05 03:58:20.035727: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-04-05 03:58:20.035740: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-04-05 03:58:20.035753: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-04-05 03:58:20.035766: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-04-05 03:58:20.035900: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/cuda/10.0.130/lib64:/sw/arcts/centos7/python/3.7.4/lib:/sw/arcts/centos7/gcc/8.2.0/lib64:/opt/slurm/lib64::
2021-04-05 03:58:20.035912: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-04-05 03:58:20.035928: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-05 03:58:20.035936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-04-05 03:58:20.035944: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2021-04-05 03:58:20.269990: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:3b:00.0
2021-04-05 03:58:20.270060: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-05 03:58:20.270075: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-05 03:58:20.270088: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-04-05 03:58:20.270101: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-04-05 03:58:20.270114: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-04-05 03:58:20.270127: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-04-05 03:58:20.270264: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/cuda/10.0.130/lib64:/sw/arcts/centos7/python/3.7.4/lib:/sw/arcts/centos7/gcc/8.2.0/lib64:/opt/slurm/lib64::
2021-04-05 03:58:20.270276: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-04-05 03:58:20.270291: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-05 03:58:20.270299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-04-05 03:58:20.270307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
run_data_domain_fair_repr.py:253: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr_all = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:254: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr_all = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:255: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr_all = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:256: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr_all = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:270: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:271: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:272: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:273: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:253: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr_all = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:254: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr_all = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:255: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr_all = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:256: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr_all = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:270: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:271: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:272: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:273: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:253: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr_all = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:254: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr_all = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:255: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr_all = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:256: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr_all = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:270: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:271: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:272: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:273: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr = np.float(tn) / np.float(tn + fp)
8
median of sqrt pairwise distance 1.4259674958809556
before data_train_marginal
after data_train_marginal
after data_valid_marginal
Equal Opportunity Criterion
Finished iteration 1000
Finished iteration 2000
Finished iteration 3000
Finished iteration 4000
Finished iteration 5000
Finished iteration 6000
Finished iteration 7000
Finished iteration 8000
Finished iteration 9000
Finished iteration 10000
Finished iteration 11000
Finished iteration 12000
Finished iteration 13000
Finished iteration 14000
Finished iteration 15000
Finished iteration 16000
Finished iteration 17000
Finished iteration 18000
Finished iteration 19000
Finished iteration 20000
Finished iteration 21000
Finished iteration 22000
Finished iteration 23000
Finished iteration 24000
Finished iteration 25000
Finished iteration 26000
Finished iteration 27000
Finished iteration 28000
Finished iteration 29000
Finished iteration 30000
Finished iteration 31000
Finished iteration 32000
Finished iteration 33000
Finished iteration 34000
Finished iteration 35000
Finished iteration 36000
Finished iteration 37000
Finished iteration 38000
Finished iteration 39000
Finished iteration 40000
Finished iteration 41000
Finished iteration 42000
Finished iteration 43000
Finished iteration 44000
Finished iteration 45000
Finished iteration 46000
Finished iteration 47000
Finished iteration 48000
Finished iteration 49000
Finished iteration 50000
after train
with Xtilde for all iterations
Regularization  10
SVM Accuracy: 84.19%
per sensitive value: 91.03, 80.81, (10.22)
SVM FPR and FNR: 7.98, 41.07
TPR per sensitive value: 51.42, 60.25, (-8.83)
FPR per sensitive value: 4.26, 10.34, (-6.09)
FNR per sensitive value: 48.58, 39.75, (8.83)
TNR per sensitive value: 95.74, 89.66, (6.09)


[0.84193333]
[-8.83396961]
[-6.08509464]
with X
CV_Scores [[0.85227059 0.84567552 0.85085736]
 [0.85293009 0.84586395 0.85066893]
 [0.85302431 0.8461466  0.85076314]
 [0.85302431 0.8461466  0.85085736]
 [0.85302431 0.8461466  0.85085736]
 [0.85302431 0.8461466  0.85085736]
 [0.85302431 0.8461466  0.85085736]]
CV Mean [0.84960116 0.84982099 0.84997802 0.85000942 0.85000942 0.85000942
 0.85000942]
SVM Accuracy: 85.35%
Reg: 1000.00
per sensitive value: 92.76, 81.68, (11.07)
SVM FPR and FNR: 6.17, 42.00
TPR per sensitive value: 50.28, 59.36, (-9.07)
FPR per sensitive value: 2.18, 8.70, (-6.52)
FNR per sensitive value: 49.72, 40.64, (9.07)
TNR per sensitive value: 97.82, 91.30, (6.52)


with Xtilde
CV_Scores [[0.87101941 0.86555493 0.86753345]
 [0.87196156 0.86451856 0.86781609]
 [0.87186735 0.86451856 0.86781609]
 [0.87186735 0.86451856 0.86781609]
 [0.87186735 0.86451856 0.86781609]
 [0.87186735 0.86451856 0.86781609]
 [0.87186735 0.86451856 0.86781609]]
CV Mean [0.86803593 0.86809874 0.86806733 0.86806733 0.86806733 0.86806733
 0.86806733]
SVM Accuracy: 84.19%
reg value: 10.00
per sensitive value: 91.03, 80.81, (10.22)
SVM FPR and FNR: 7.98, 41.07
TPR per sensitive value: 51.42, 60.25, (-8.83)
FPR per sensitive value: 4.26, 10.34, (-6.09)
FNR per sensitive value: 48.58, 39.75, (8.83)
TNR per sensitive value: 95.74, 89.66, (6.09)


Encoder Accuracy: 83.67%
per sensitive value: 90.50, 80.29, (10.21)
Encoder FPR and FNR: 8.81, 40.59
TPR per sensitive value: 48.58, 61.31, (-12.73)
FPR per sensitive value: 4.50, 11.54, (-7.04)
FNR per sensitive value: 51.42, 38.69, (12.73)
TNR per sensitive value: 95.50, 88.46, (7.04)
after test
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From run_data_domain_fair_repr.py:594: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:305: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:314: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/musicer/fairness/env/lib/python3.7/site-packages/tensorflow_core/python/util/deprecation.py:507: UniformUnitScaling.__init__ (from tensorflow.python.ops.init_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.initializers.variance_scaling instead with distribution=uniform to get equivalent behavior.
WARNING:tensorflow:From run_data_domain_fair_repr.py:50: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.Dense instead.
WARNING:tensorflow:From /home/musicer/fairness/env/lib/python3.7/site-packages/tensorflow_core/python/layers/core.py:187: Layer.apply (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
WARNING:tensorflow:From run_data_domain_fair_repr.py:322: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /home/musicer/fairness/env/lib/python3.7/site-packages/tensorflow_core/python/ops/nn_impl.py:183: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From run_data_domain_fair_repr.py:57: The name tf.diag_part is deprecated. Please use tf.linalg.tensor_diag_part instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:80: The name tf.trace is deprecated. Please use tf.linalg.trace instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:461: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:461: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:464: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:469: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:479: The name tf.summary.merge_all is deprecated. Please use tf.compat.v1.summary.merge_all instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:483: The name tf.assign is deprecated. Please use tf.compat.v1.assign instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:600: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:502: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:510: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2021-04-05 04:00:05.251598: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2021-04-05 04:00:05.259620: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2400000000 Hz
2021-04-05 04:00:05.259727: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0xabff920 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-04-05 04:00:05.259739: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-04-05 04:00:05.262639: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-04-05 04:00:05.410505: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0xac01a80 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-04-05 04:00:05.410535: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla V100-PCIE-16GB, Compute Capability 7.0
2021-04-05 04:00:05.411352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:3b:00.0
2021-04-05 04:00:05.413455: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-05 04:00:05.416917: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-05 04:00:05.419533: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-04-05 04:00:05.420834: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-04-05 04:00:05.424057: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-04-05 04:00:05.426801: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-04-05 04:00:05.426953: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/cuda/10.0.130/lib64:/sw/arcts/centos7/python/3.7.4/lib:/sw/arcts/centos7/gcc/8.2.0/lib64:/opt/slurm/lib64::
2021-04-05 04:00:05.426967: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-04-05 04:00:05.426996: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-05 04:00:05.427005: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-04-05 04:00:05.427015: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
WARNING:tensorflow:From run_data_domain_fair_repr.py:512: The name tf.set_random_seed is deprecated. Please use tf.compat.v1.set_random_seed instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:516: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:518: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

WARNING:tensorflow:From run_data_domain_fair_repr.py:351: calling argmax (from tensorflow.python.ops.math_ops) with dimension is deprecated and will be removed in a future version.
Instructions for updating:
Use the `axis` argument instead
2021-04-05 06:01:08.108873: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:3b:00.0
2021-04-05 06:01:08.108995: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-05 06:01:08.109015: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-05 06:01:08.109033: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-04-05 06:01:08.109050: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-04-05 06:01:08.109064: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-04-05 06:01:08.109081: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-04-05 06:01:08.117845: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/cuda/10.0.130/lib64:/sw/arcts/centos7/python/3.7.4/lib:/sw/arcts/centos7/gcc/8.2.0/lib64:/opt/slurm/lib64::
2021-04-05 06:01:08.117862: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-04-05 06:01:08.117878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-05 06:01:08.117887: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-04-05 06:01:08.117895: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2021-04-05 06:01:08.596967: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:3b:00.0
2021-04-05 06:01:08.597039: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-05 06:01:08.597055: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-05 06:01:08.597068: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-04-05 06:01:08.597082: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-04-05 06:01:08.597095: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-04-05 06:01:08.597107: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-04-05 06:01:08.597244: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/cuda/10.0.130/lib64:/sw/arcts/centos7/python/3.7.4/lib:/sw/arcts/centos7/gcc/8.2.0/lib64:/opt/slurm/lib64::
2021-04-05 06:01:08.597257: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-04-05 06:01:08.597273: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-05 06:01:08.597281: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-04-05 06:01:08.597289: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2021-04-05 06:01:08.835083: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:3b:00.0
2021-04-05 06:01:08.835155: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-05 06:01:08.835171: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-05 06:01:08.835184: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-04-05 06:01:08.835197: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-04-05 06:01:08.835220: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-04-05 06:01:08.835233: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-04-05 06:01:08.835364: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/cuda/10.0.130/lib64:/sw/arcts/centos7/python/3.7.4/lib:/sw/arcts/centos7/gcc/8.2.0/lib64:/opt/slurm/lib64::
2021-04-05 06:01:08.835376: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-04-05 06:01:08.835391: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-05 06:01:08.835399: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-04-05 06:01:08.835407: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
run_data_domain_fair_repr.py:253: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr_all = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:254: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr_all = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:255: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr_all = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:256: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr_all = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:270: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:271: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:272: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:273: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:253: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr_all = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:254: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr_all = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:255: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr_all = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:256: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr_all = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:270: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:271: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:272: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:273: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:253: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr_all = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:254: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr_all = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:255: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr_all = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:256: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr_all = np.float(tn) / np.float(tn + fp)
run_data_domain_fair_repr.py:270: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fpr = np.float(fp) / np.float(fp + tn)
run_data_domain_fair_repr.py:271: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  fnr = np.float(fn) / np.float(fn + tp)
run_data_domain_fair_repr.py:272: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tpr = np.float(tp) / np.float(tp + fn)
run_data_domain_fair_repr.py:273: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  tnr = np.float(tn) / np.float(tn + fp)
9
median of sqrt pairwise distance 1.426173278035614
before data_train_marginal
after data_train_marginal
after data_valid_marginal
Equal Opportunity Criterion
Finished iteration 1000
Finished iteration 2000
Finished iteration 3000
Finished iteration 4000
Finished iteration 5000
Finished iteration 6000
Finished iteration 7000
Finished iteration 8000
Finished iteration 9000
Finished iteration 10000
Finished iteration 11000
Finished iteration 12000
Finished iteration 13000
Finished iteration 14000
Finished iteration 15000
Finished iteration 16000
Finished iteration 17000
Finished iteration 18000
Finished iteration 19000
Finished iteration 20000
Finished iteration 21000
Finished iteration 22000
Finished iteration 23000
Finished iteration 24000
Finished iteration 25000
Finished iteration 26000
Finished iteration 27000
Finished iteration 28000
Finished iteration 29000
Finished iteration 30000
Finished iteration 31000
Finished iteration 32000
Finished iteration 33000
Finished iteration 34000
Finished iteration 35000
Finished iteration 36000
Finished iteration 37000
Finished iteration 38000
Finished iteration 39000
Finished iteration 40000
Finished iteration 41000
Finished iteration 42000
Finished iteration 43000
Finished iteration 44000
Finished iteration 45000
Finished iteration 46000
Finished iteration 47000
Finished iteration 48000
Finished iteration 49000
Finished iteration 50000
after train
with Xtilde for all iterations
Regularization  10
SVM Accuracy: 83.89%
per sensitive value: 90.83, 80.53, (10.30)
SVM FPR and FNR: 8.49, 39.63
TPR per sensitive value: 57.07, 60.96, (-3.89)
FPR per sensitive value: 4.82, 10.77, (-5.95)
FNR per sensitive value: 42.93, 39.04, (3.89)
TNR per sensitive value: 95.18, 89.23, (5.95)


[0.83886667]
[-3.89139392]
[-5.94514857]
with X
CV_Scores [[0.85688713 0.84746561 0.84972678]
 [0.85698135 0.84727718 0.85038628]
 [0.85698135 0.84727718 0.85010364]
 [0.85707556 0.84727718 0.85000942]
 [0.85707556 0.84727718 0.85000942]
 [0.85707556 0.84727718 0.85000942]
 [0.85707556 0.84727718 0.85000942]]
CV Mean [0.85135984 0.85154827 0.85145405 0.85145405 0.85145405 0.85145405
 0.85145405]
SVM Accuracy: 84.89%
Reg: 10.00
per sensitive value: 92.64, 81.13, (11.51)
SVM FPR and FNR: 6.00, 43.23
TPR per sensitive value: 48.12, 58.32, (-10.20)
FPR per sensitive value: 1.61, 8.72, (-7.11)
FNR per sensitive value: 51.88, 41.68, (10.20)
TNR per sensitive value: 98.39, 91.28, (7.11)


with Xtilde
CV_Scores [[0.87403429 0.86875824 0.86875824]
 [0.87412851 0.86904089 0.8684756 ]
 [0.87403429 0.86904089 0.8684756 ]
 [0.87403429 0.86904089 0.8684756 ]
 [0.87403429 0.86904089 0.8684756 ]
 [0.87403429 0.86904089 0.8684756 ]
 [0.87403429 0.86904089 0.8684756 ]]
CV Mean [0.87051693 0.87054833 0.87051693 0.87051693 0.87051693 0.87051693
 0.87051693]
SVM Accuracy: 83.89%
reg value: 10.00
per sensitive value: 90.83, 80.53, (10.30)
SVM FPR and FNR: 8.49, 39.63
TPR per sensitive value: 57.07, 60.96, (-3.89)
FPR per sensitive value: 4.82, 10.77, (-5.95)
FNR per sensitive value: 42.93, 39.04, (3.89)
TNR per sensitive value: 95.18, 89.23, (5.95)


Encoder Accuracy: 82.29%
per sensitive value: 89.58, 78.77, (10.81)
Encoder FPR and FNR: 13.83, 29.66
TPR per sensitive value: 64.04, 71.47, (-7.42)
FPR per sensitive value: 7.13, 17.99, (-10.86)
FNR per sensitive value: 35.96, 28.53, (7.42)
TNR per sensitive value: 92.87, 82.01, (10.86)
after test
